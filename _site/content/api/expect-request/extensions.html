<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>ExpectRequest Extensions | Welcome the Expected.Request’s documentation!</title>
<meta property="og:title" content="ExpectRequest Extensions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Expected.Request, a simple API testing framework." />
<meta property="og:description" content="Expected.Request, a simple API testing framework." />
<link rel="canonical" href="http://localhost:4000/content/api/expect-request/extensions.html" />
<meta property="og:url" content="http://localhost:4000/content/api/expect-request/extensions.html" />
<meta property="og:site_name" content="Welcome the Expected.Request’s documentation!" />
<script type="application/ld+json">
{"name":null,"description":"Expected.Request, a simple API testing framework.","author":null,"@type":"WebPage","url":"http://localhost:4000/content/api/expect-request/extensions.html","publisher":null,"image":null,"headline":"ExpectRequest Extensions","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=8f5fc4ef04f1d94c7fad5afbcc21c2c3fe96cc79">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Welcome the Expected.Request's documentation!</h1>
        <p>Expected.Request, a simple API testing framework.</p>

        
          <p class="view"><a href="http://github.com/wright-development/Expected.Request">View the Project on GitHub <small></small></a></p>
        

        

        
      </header>
      <section>

      <h2 id="map-extensions">Map Extensions</h2>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">retrieveObject</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">expectedAction</span><span class="p">,</span> <span class="n">IContentConverter</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">converter</span><span class="p">)</span>
</code></pre>
</div>

<p><strong>Map</strong> does exactly what the method name implies, it maps the HttpReponseMessage’s content into the object type specified. Then using the Action that the caller provides supplies the type.</p>

<h2 id="expect-extensions">Expect Extensions</h2>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Expect</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Task</span><span class="p">&gt;</span> <span class="n">taskFunc</span><span class="p">,</span> <span class="kt">string</span> <span class="n">assertMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Expect</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Task</span><span class="p">&gt;</span> <span class="n">taskFunc</span><span class="p">,</span> <span class="n">IContentConverter</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">converter</span><span class="p">,</span> <span class="kt">string</span> <span class="n">assertMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>

<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Expect</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">expectedAction</span><span class="p">,</span> <span class="kt">string</span> <span class="n">assertMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Expect</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">expectedAction</span><span class="p">,</span> <span class="n">IContentConverter</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">converter</span><span class="p">,</span> <span class="kt">string</span> <span class="n">assertMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span> 
</code></pre>
</div>

<p>There are two forms of the <strong>Expect</strong> function, one that takes a function of type T that returns a task and the other simply takes an action of type T. The function is used when you need to pass an async lambda for your assertion against the object of type T. Whereas the action is used for simple assertions that do not require async calls. In both cases when you do not provide an <strong>IContentConverter</strong> by default the code will use the **JsonContentConverter<T>** and map the HttpResponseMessage's content to JSON. Finally, you have the ability to specify the assertion message that you would like to display if your expectation does not complete successfully.</T></p>

<p><strong>Example</strong></p>
<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TodoModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Id</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
    <span class="c1">//...
</span><span class="p">}</span>
<span class="c1">//...assertion
</span><span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo/1"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Expect</span><span class="p">&lt;</span><span class="n">TodoModel</span><span class="p">&gt;(</span><span class="n">model</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="s">"1"</span><span class="p">);</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>

</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectContent</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">expectedContent</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectContent</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">expectedContentAction</span><span class="p">);</span>
</code></pre>
</div>

<p><strong>ExpectContent</strong> allows the caller to expect the exact content to match, in the case of the first function, or perform a custom action assertion in the case of the second function.</p>

<p><strong>Example</strong></p>
<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/values/1"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">ExpectContent</span><span class="p">(</span><span class="s">"value"</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>


<span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/values/1"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">ExpectContent</span><span class="p">(</span> <span class="n">content</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="s">"value"</span><span class="p">)</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>
</code></pre>
</div>

<h2 id="request-extensions">Request Extensions</h2>

<h3 id="retrieve-content-extension">Retrieve Content Extension</h3>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">async</span> <span class="k">static</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">GetContent</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">contentRetriever</span><span class="p">);</span>
</code></pre>
</div>

<p><strong>GetContent</strong> allows the caller to retrieve the value of the HttpResponseMessage’s content.</p>

<p><strong>Example</strong></p>
<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="kt">string</span> <span class="n">content</span><span class="p">;</span>
<span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">GetContent</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">content</span> <span class="p">=</span> <span class="n">c</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>
</code></pre>
</div>

<h3 id="verb-extensions">Verb Extensions</h3>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">Get</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Post</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">,</span> <span class="n">T</span> <span class="n">content</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="n">Put</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">,</span> <span class="n">T</span> <span class="n">content</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">Post</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">,</span> <span class="n">HttpContent</span> <span class="n">content</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">Put</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">,</span> <span class="n">HttpContent</span> <span class="n">content</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">Delete</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">);</span>
</code></pre>
</div>

<p>All of the verb functions perform a request against the specified URL provided. These extension method calls remove the need to call <strong>.Request()</strong> first, and simply perform both the request and verb calls.</p>

<p><strong>Example</strong></p>
<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">ExpectOk</span><span class="p">()</span>    
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo/1"</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>

<span class="kt">var</span> <span class="n">model</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TodoModel</span><span class="p">{</span><span class="n">Title</span> <span class="p">=</span> <span class="s">"title"</span><span class="p">};</span>
<span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">ExpectOk</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Post</span><span class="p">&lt;</span><span class="n">TodoModel</span><span class="p">&gt;(</span><span class="s">"http://localhost:8080/api/todo/1"</span><span class="p">,</span> <span class="n">model</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">ExpectOk</span><span class="p">()</span>    
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>
</code></pre>
</div>

<h2 id="header-extensions">Header Extensions</h2>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectHeader</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">headerKey</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectHeaders</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">headers</span><span class="p">);</span>

<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectHeader</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="kt">string</span> <span class="n">headerKey</span><span class="p">,</span> <span class="kt">string</span> <span class="n">headerValue</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectHeaders</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">headers</span><span class="p">);</span>
</code></pre>
</div>

<p><strong>ExpectHeader</strong> and <strong>ExpectHeaders</strong> have the ability to either check if a header exists or exist with a specific value.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">ExpectHeader</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>    
</code></pre>
</div>

<h2 id="statuscode-extensions">StatusCode Extensions</h2>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectStatusCode</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">,</span> <span class="n">HttpStatusCode</span> <span class="n">expectedStatusCode</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectOk</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectNotFound</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">);</span>
<span class="n">Task</span><span class="p">&lt;</span><span class="n">IExpectRequest</span><span class="p">&gt;</span> <span class="nf">ExpectUnavailable</span><span class="p">(</span><span class="k">this</span> <span class="n">IExpectRequest</span> <span class="n">expect</span><span class="p">);</span>
</code></pre>
</div>

<p><strong>Examples</strong></p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">ExpectOk</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>


<span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"http://localhost:8080/api/todo"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">ExpectStatusCode</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>    
</code></pre>
</div>

<p><strong><a href="/api/expect-request">Back to ExpectRequest</a></strong></p>


      </section>
      <footer>
        
        <p>This project is maintained by <a href="http://github.com/wright-development">wright-development</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>


  
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-61721549-2', 'auto');
        ga('send', 'pageview');
    </script>
  
  </body>
</html>
