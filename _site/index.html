<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Welcome the Expected.Request’s documentation! | Expected.Request, a simple API testing framework.</title>
<meta property="og:title" content="Welcome the Expected.Request’s documentation!" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Expected.Request, a simple API testing framework." />
<meta property="og:description" content="Expected.Request, a simple API testing framework." />
<meta property="og:site_name" content="Welcome the Expected.Request’s documentation!" />
<script type="application/ld+json">
{"name":"Welcome the Expected.Request’s documentation!","description":"Expected.Request, a simple API testing framework.","author":null,"@type":"WebSite","url":"/","publisher":null,"image":null,"headline":"Welcome the Expected.Request’s documentation!","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=ca796bb340b22044d4a9fbeb43722c73b4c591f6">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Welcome the Expected.Request's documentation!</h1>
        <p>Expected.Request, a simple API testing framework.</p>

        
          <p class="view"><a href="http://github.com/wright-development/Expected.Request">View the Project on GitHub <small></small></a></p>
        

        

        
      </header>
      <section>

      <p><img src="https://api.travis-ci.org/wright-development/Expected.Request.svg?branch=master" alt="" /></p>

<p><strong>Documentation in progress.</strong></p>

<p>Just as the name suggests Expected.Request helps you define what you <strong>expect</strong> out of your requests.</p>

<p>Expected Request is a Fluent API that guides you through your API testing, and it all starts by creating a <strong>new Request</strong>.</p>

<h2 id="installation">Installation</h2>

<p>You can install Expected.Request by copying and pasting the following command into your Package Manager Console within Visual Studio (Tools &gt; NuGet Package Manager &gt; Package Manager Console).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Install-Package Expected.Request
</code></pre>
</div>

<p>Or using the .NET Core CLI you can install Expected.Request via the command line interface with the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>dotnet add package Expected.Request
</code></pre>
</div>

<h2 id="simple-usage">Simple usage</h2>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="kt">var</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">();</span>
</code></pre>
</div>

<p>Once you have created a request, let the chaining begin! Currently the project supports the four basic requests <strong>Get, Post, Put, and Delete</strong>. Let’s try a Post, and we expect to get a status code of ok.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="c1">//assuming we have an api setup
</span><span class="kt">var</span> <span class="n">todoItem</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TodoModel</span> <span class="p">{</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Walk the dog"</span><span class="p">,</span> <span class="n">Done</span> <span class="p">=</span> <span class="k">false</span> <span class="p">};</span>
<span class="k">await</span> <span class="n">request</span>
    <span class="p">.</span><span class="nf">Post</span><span class="p">(</span><span class="s">"http://localhost:3000/api/todo"</span><span class="p">,</span> <span class="n">todoItem</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">ExpectOk</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>
</code></pre>
</div>

<p>Simple right? The idea behind Expected.Request is to test your APIs in a clear and cohesive way. Essentially you should be able to read your API tests. In this example we create a new request, post to the todo API with our model, then once the post is complete we expect the status code to be ok, and finally, we call done. Calling done at the end ensures that everything is disposed of properly.</p>

<h2 id="more-complex-usage">More complex usage</h2>

<p>Alright, let’s get into a more complex example. We’ll post a model to the todo api, then use the id we will retrieve the content response from the API, and finally, perform some assertions on the object.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="kt">var</span> <span class="n">apiUrl</span> <span class="p">=</span> <span class="s">"http://localhost:3000/api/todo"</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">todoItem</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TodoModel</span> <span class="p">{</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Walk the dog"</span><span class="p">,</span> <span class="n">Done</span> <span class="p">=</span> <span class="k">false</span> <span class="p">};</span>

<span class="kt">string</span> <span class="n">id</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>

<span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Post</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span> <span class="n">todoItem</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">TodoModel</span><span class="p">&gt;(</span><span class="n">model</span><span class="p">=&gt;</span><span class="n">id</span> <span class="p">=</span> <span class="n">model</span><span class="p">.</span><span class="n">Id</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">ExpectOk</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="err">$</span><span class="s">"{apiUrl}/{id}"</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">ExpectOk</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Expect</span><span class="p">&lt;</span><span class="n">TodoModel</span><span class="p">&gt;(</span><span class="n">model</span><span class="p">=&gt;</span> <span class="p">{</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">Checked</span><span class="p">,</span> <span class="n">todoItem</span><span class="p">.</span><span class="n">Checked</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">todoItem</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>
</code></pre>
</div>

<p>Once again with a few calls, we have a fairly self-explanatory API test.</p>

<h2 id="using-with-microsofts-testserver">Using with Microsoft’s TestServer</h2>

<p>Expected.Request also works well with the TestServer class that Microsoft provides in their Microsoft.AspNetCore.TestHost package. Once you have instantiated the TestServer, provide a new client to the request. Then feel free to chain your calls as you would normally.</p>

<p><strong>For more information about TestServer head over to Microsoft’s <a href="https://docs.microsoft.com/en-us/aspnet/core/testing/integration-testing">documentation</a></strong></p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ValuesApiTests</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">TestServer</span> <span class="n">_server</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">_client</span><span class="p">;</span>
    <span class="k">public</span> <span class="nf">ValuesApiTests</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_server</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TestServer</span><span class="p">(</span><span class="k">new</span> <span class="nf">WebHostBuilder</span><span class="p">()</span>
            <span class="p">.</span><span class="n">UseStartup</span><span class="p">&lt;</span><span class="n">Startup</span><span class="p">&gt;());</span>
        <span class="n">_client</span> <span class="p">=</span> <span class="n">_server</span><span class="p">.</span><span class="nf">CreateClient</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">check_api_values</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">await</span> <span class="k">new</span> <span class="nf">Request</span><span class="p">(</span><span class="n">_client</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"/api/values"</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">ExpectOk</span><span class="p">())</span>
            <span class="p">.</span><span class="nf">Next</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Expect</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;&gt;((</span><span class="n">reponse</span><span class="p">)=&gt;{</span>
                <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">reponse</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="m">0</span><span class="p">),</span><span class="s">"value1"</span><span class="p">);</span>
                <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">reponse</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="s">"value2"</span><span class="p">);</span>
            <span class="p">}))</span>
            <span class="p">.</span><span class="nf">Done</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>If you have any questions or suggestions for this project feel free to post an <a href="https://github.com/wright-development/Expected.Request/issues">issue on github</a>.</strong></p>


      </section>
      <footer>
        
        <p>This project is maintained by <a href="http://github.com/wright-development">wright-development</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>


  
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-61721549-2', 'auto');
        ga('send', 'pageview');
    </script>
  
  </body>
</html>
